{% load bootstrap4 %} {% load static %}
<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8"> 
    <title>Maps</title>
    <!-- css -->
    {% block styles %} {% bootstrap_css %}
    <link rel="stylesheet" href="{% static 'css/main.css' %}"> {% endblock %}
    <!--scripts  -->
    {% block scripts %}
    <!-- jquery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <!-- pooper -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.13.0/popper.min.js"></script> 
    {% bootstrap_javascript %}
    <script defer src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script> 
    <script>
        // GOOGLE MAPS
            // Note: This example requires that you consent to location sharing when
            // prompted by your browser. If you see the error "The Geolocation service
            // failed.", it means you probably did not give permission for the browser to
            // locate you.
            var map, infoWindow;
            var lat = "{{latitude}}";
            latitude = parseFloat(lat)
            console.log(latitude)
    
            var lng = "{{longitude}}";
            longitude = parseFloat(lng);
            console.log(longitude)
            function initMap() {
                map = new google.maps.Map(document.getElementById('map'), {
                    center: { lat: latitude , lng: longitude  },
                    zoom: 14
                });

                // Add Marker Function
                function addMarker(props) {
                    var marker = new google.maps.Marker({
                        position: props.coords,
                        map: map,
                        //icon:props.iconImage
                    });


                }

                // Listen for click on map.
                google.maps.event.addListener(map, 'click', function (event) {
                    // Add marker
                    addMarker({
                        coords: event.latLng
                    });
                });

                infoWindow = new google.maps.InfoWindow;

                // Try HTML5 geolocation.
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(function (position) {
                        var pos = {
                            lat: position.coords.latitude,
                            lng: position.coords.longitude
                        };

                        infoWindow.setPosition(pos);
                        infoWindow.setContent('Location found.');
                        infoWindow.open(map);
                        map.setCenter(pos);
                    }, function () {
                        handleLocationError(true, infoWindow, map.getCenter());
                    });
                } else {
                    // Browser doesn't support Geolocation
                    handleLocationError(false, infoWindow, map.getCenter());
                }
            }

            function handleLocationError(browserHasGeolocation, infoWindow, pos) {
                infoWindow.setPosition(pos);
                infoWindow.setContent(browserHasGeolocation ?
                    'Error: The Geolocation service failed.' :
                    'Error: Your browser doesn\'t support geolocation.');
                infoWindow.open(map);
            }
    </script>
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA5iOQWIMe4tpZ1fcMgDbQXg8Ni6wRxk-s&callback=initMap"></script>
    
    {% comment %} <script src="{% static 'js/main.js' %}" type="text/javascript" charset="utf-8"></script> {% endcomment %}
    {% endblock %}
</head>

<body>
    {% block content %}
    {% endblock %}
</body>

</html>